We present a novel task-parallel algorithm for the LU factorization of hierarchical matrices (H-matrices). These arise from, e.g., boundary element methods. H-matrix arithmetic typically exhibits complicated dependency patterns which pose a challenge for effective parallelization. Existing methods express these dependencies with in/out parameter qualifiers. In this work, we investigate the use of the future construct as an alternative. Futures serve as placeholders for eventually computed values and have been used to express similarly complicated dependencies in other contexts. Unfortunately, support for futures in current runtime systems is insufficient.
Therefore, we implemented our own proof-of-concept runtime system atop the C++20 standard. It is designed as a header-only library and utilizes coroutines to model tasks. We use task dependencies not only to determine the order of execution, but also for effective load balancing.
Our results show that the approach provides a clear, concise and reasonably efficient way to perform the parallel H-LU factorization.
